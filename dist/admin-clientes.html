<!doctype html><html lang="es-GT"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">
<title>Clientes • Admin</title>
<link rel="stylesheet" href="./assets/css/clean.css">
<script>
 window.API_BASE_URL = "https://super-proyecto.onrender.com";
  window.SUPABASE_URL = "https://cfpkiklvmsmonqvmjzuy.supabase.co";   /* REEMPLAZA */
  window.SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImNmcGtpa2x2bXNtb25xdm1qenV5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjExNTI4MjIsImV4cCI6MjA3NjcyODgyMn0.kK2DBGI_Hun0_DWmsqV15yGRYpPsyx-akNKlqKXoZCQ";                        /* REEMPLAZA */
</script>
</head><body class="container">
<header class="header" style="margin-bottom:16px;display:flex;justify-content:space-between;align-items:center">
  <strong>Clientes</strong>
  <nav style="display:flex;gap:8px">
    <a class="btn" href="./admin-dashboard.html">Inicio</a>
    <button class="btn" id="logout">Salir</button>
  </nav>
</header>

<section class="card" style="padding:16px">
  <div id="count" class="text-muted"></div>
  <table class="table" id="tbl"></table>
</section>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2.45.4/dist/umd/supabase.min.js"></script>
<script src="./assets/js/auth.js"></script>
<script>
document.getElementById('logout').onclick = signOut;

async function load(page=1){
  const r = await fetchAuth(`${API_BASE_URL}/api/admin/users?page=${page}&size=50`);
  document.getElementById('count').textContent = `${r.count} clientes`;
  const rows = (r.items||[]).map(u=>`
    <tr>
      <td>${u.full_name||''}</td>
      <td>${u.email}</td>
      <td>${u.auth_user_id ? u.auth_user_id.slice(0,8)+'…' : '-'}</td>
      <td>${new Date(u.created_at).toLocaleString()}</td>
    </tr>
  `).join('');
  document.getElementById('tbl').innerHTML = `
    <thead><tr><th>Nombre</th><th>Email</th><th>Auth ID</th><th>Creado</th></tr></thead>
    <tbody>${rows}</tbody>`;
}
ensureAdmin().then(ok => ok && load());
</script>
</body></html>
